<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historias ‚Äì Grupo L√°zaro</title>
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <header class="header-fixed">
    <div class="container flex">
      <img src="img/logo.png" alt="Logo Grupo L√°zaro" class="logo">
      <nav>
        <ul class="menu flex">
          <li><a href="index.html">Home</a></li>
          <li><a href="noticias.html">Noticias</a></li>
          <li><a href="unirme.html">Unirme</a></li>
          <li><a href="historias.html">Historias</a></li>
          <li><a href="nosotros.html">Nosotros</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Head + title "Historias de Esperanza" -->

  <body>
    <!-- Header com√∫n -->

    <main class="container">
      <h1>Muro de Historias de Esperanza</h1>
      <div class="grid-historias">
        <div class="card-historia">
          <p>"Llevo 5 a√±os con EM y hoy soy mam√° feliz"</p>
          <small>An√≥nimo ‚Äì 2025</small>
        </div>
        <!-- M√°s cards cuando tengamos historias reales -->
      </div>
    </main>

    <!-- Footer com√∫n -->
    <footer class="footer">
      <div class="container">
        <p>Grupo L√°zaro ¬© 2025 ‚Äì No est√°s solo ‚ù§Ô∏è</p>
        <p>Contactanos: matii.toorres.06@gmail.com</p>
      </div>
    </footer>
    <script>
      // Detectar entorno: localhost o producci√≥n
      const _DEFAULT_API = "https://lazaro-backend-sqlite.onrender.com/api";
      const API_URL = (location.hostname === 'localhost' || location.hostname === '127.0.0.1')
        ? 'http://localhost:5000/api'
        : _DEFAULT_API;

      async function loadStories() {
        try {
          const res = await fetch(`${API_URL}/stories`);
          if (!res.ok) throw new Error('Error ' + res.status);
          const stories = await res.json();

          const gridDiv = document.querySelector('.grid-historias');
          if (!gridDiv) return;

          // Limpiar solo los cards generados (mantener el primero de ejemplo si lo hay)
          const cards = gridDiv.querySelectorAll('.card-historia');
          if (cards.length > 1) {
            cards.forEach((c, i) => { if (i > 0) c.remove(); }); // mantener el primero
          }

          if (!stories || stories.length === 0) {
            const msg = document.createElement('p');
            msg.textContent = 'Pronto habr√° historias inspiradoras... üíö';
            gridDiv.appendChild(msg);
            return;
          }

          stories.forEach(story => {
            const div = document.createElement('div');
            div.className = 'card-historia';
            div.innerHTML = `<p>"${story.historia}"</p><small>An√≥nimo ‚Äì ${story.createdAt.slice(0, 10)}</small>`;
            gridDiv.appendChild(div);
          });
        } catch(err){
          console.error('Error loading stories from', API_URL, err);
          // No mostrar alerta, solo fallar silenciosamente
        }
      }

      loadStories();
    </script>

  </body>

</html>